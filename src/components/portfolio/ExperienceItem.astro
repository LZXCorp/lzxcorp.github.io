---
/**
 * ExperienceItem
 *
 * Props:
 * - title: string — Role title
 * - company: string — Company or organization name
 * - description: string — Short description of the experience
 * - date: string — Human-readable date range
 * - link?: string — Optional external URL; when provided, company and logo become a link
 * - logo?: string — Optional path to a transparent company logo image
 * - index?: number — Optional index for loading optimization
 */
interface Props {
  title: string;
  company: string;
  description: string;
  link?: string;
  date: string;
  logo?: string;
  index?: number;
}

const { title, company, description, link, date, logo, index = 0 } = Astro.props as Props;
---

<div
  class="relative mx-12 pb-12 grid md:grid-cols-5 md:gap-10 before:absolute before:left-[-35px] before:block before:h-full before:border-l-2 before:border-black/20 dark:before:border-white/15 before:content-['']"
>
  <div class="pb-12 md:col-span-2">
    <div class="sticky top-0">
      {
        logo ? (
          link ? (
            <a
              href={link}
              target="_blank"
              rel="noopener noreferrer"
              aria-label={`Visit ${company} website`}
              class="absolute -left-[59px] h-12 w-12 rounded-full overflow-hidden ring-2 ring-black/20 dark:ring-white/25 bg-white flex items-center justify-center p-1.5"
            >
              <img
                src={logo}
                alt={`${company} logo`}
                loading={index < 2 ? "eager" : "lazy"}
                fetchpriority={index < 2 ? "high" : "auto"}
                decoding="async"
                class="h-full w-full object-contain select-none [image-rendering:auto]"
              />
            </a>
          ) : (
            <span
              class="absolute -left-[59px] h-12 w-12 rounded-full overflow-hidden ring-2 ring-black/20 dark:ring-white/25 bg-white flex items-center justify-center p-1.5"
            >
              <img
                src={logo}
                alt={`${company} logo`}
                loading={index < 2 ? "eager" : "lazy"}
                fetchpriority={index < 2 ? "high" : "auto"}
                decoding="async"
                class="h-full w-full object-contain select-none [image-rendering:auto]"
              />
            </span>
          )
        ) : (
          <span
            class="absolute -left-[42px] text-5xl text-mint-400 rounded-full drop-shadow-[0px_0px_8px_rgba(244,63,94,1)]"
            >&bull;</span
          >
        )
      }
      <h3
        class="text-2xl font-bold text-mint-400"
      >
        {title}
      </h3>
      {
        link ? (
          <a
            href={link}
            target="_blank"
            rel="noopener noreferrer"
            aria-label={`Visit ${company} website`}
            class="group block"
          >
            <h4 class="text-lg leading-snug font-semibold text-zinc-600 dark:text-white group-hover:underline">
              {company}
            </h4>
          </a>
        ) : (
          <div class="block">
            <h4 class="text-lg leading-snug font-semibold text-zinc-600 dark:text-white">
              {company}
            </h4>
          </div>
        )
      }
      <time datetime={date} class="block mt-0.5 text-sm text-zinc-600/80 dark:text-white/80">
        {date}
      </time>
    </div>
  </div>
  <div
    class="flex flex-col gap-2 pb-4 text-zinc-00 dark:text-zinc-300 md:col-span-3"
  >
    {description}
  </div>
</div>
